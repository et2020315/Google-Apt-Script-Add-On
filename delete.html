<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!-- <script src="https://unpkg.com/js-logger/src/logger.min.js"></script> -->
    <script>

// delete experience
    function deleteCheckedItems3(jsonString){
      var json3list = JSON.parse(jsonString);
      var expvNum = document.getElementById("text-exp-view").value -1;
      if (expvNum < json3list.length && expvNum >=0){
        var json3 = json3list[expvNum];
        json3list.splice(expvNum, 1);
        console.log("---------");
        console.log(json3list);
        google.script.run.saveExperience(JSON.stringify(json3list));
        document.getElementById("experienceMessage").innerHTML = "the experience was deleted.";
      }
      else{
        alert("Please enter a valid number");
      }
    }

// delete header
    function deleteCheckedItems2(jsonString){
      var json2 = JSON.parse(jsonString);
      console.log("********************");
      console.log(json2);
      json2["fname"] = " ";
      json2["lname"] = " ";
      json2["email"] = " ";
      json2["phone"] = " ";
      json2["lkacc"] = " ";
      json2["porturl"] = " ";
      
      console.log("---------");
      google.script.run.saveHeader(JSON.stringify(json2));
      document.getElementById("headerMessage").innerHTML = "the header was deleted.";
      console.log("save header");
    }

// delete education
    function deleteCheckedItems1(jsonString){
      var json1list = JSON.parse(jsonString);
      var eduvNum = document.getElementById("text-edu-view").value -1;
      if (eduvNum < json1list.length && eduvNum >=0){
        var json1 = json1list[eduvNum];
        console.log("********************");
        console.log(json1);
        json1list.splice(eduvNum, 1);
        console.log("---------");
        console.log(json1list);
        google.script.run.saveEducation(JSON.stringify(json1list));
        document.getElementById("educationMessage").innerHTML = "the education was deleted.";
      }
      else{
        alert("Please enter a valid number");
      }
    }

// delete honor
    function deleteCheckedItems4(jsonString){
      var json4list = JSON.parse(jsonString);
      var hrnvNum = document.getElementById("text-hon-view").value -1;
      if (hrnvNum < json4list.length && hrnvNum >=0){
        var json4 = json4list[hrnvNum];
        console.log("********************");
        console.log(json4);
        json4list.splice(hrnvNum, 1);
        console.log("---------");
        console.log(json4list);
        google.script.run.saveHonor(JSON.stringify(json4list));
        document.getElementById("honorMessage").innerHTML = "the honor was deleted.";
      }
      else{
        alert("Please enter a valid number");
      }
    }


// delete skill
    
    function deleteCheckedItems5(jsonString){
    
      var json5list = JSON.parse(jsonString);
      var SKvNum = document.getElementById("text-skl-view").value -1;
      if (SKvNum < json5list.length && SKvNum >=0){
        var json5 = json5list[SKvNum];
        console.log("********************");
        console.log(json5);
        json5list.splice(SKvNum, 1);
        console.log("---------");
        console.log(json5list);
        google.script.run.saveAllSkills(JSON.stringify(json5list));
        document.getElementById("skillMessage").innerHTML = "the skill was deleted.";
      }
      else{
        alert("Please enter a valid number");
      }
      
    }

// delete free text
    function deleteCheckedItems6(jsonString){
    
      var json6list = JSON.parse(jsonString);
      var SKvNum = document.getElementById("text-ft-view").value -1;
      if (SKvNum < json6list.length && SKvNum >=0){
        var json6 = json6list[SKvNum];
        console.log("********************");
        console.log(json6);
        json6list.splice(SKvNum, 1);
        console.log("---------");
        console.log(json6list);
        google.script.run.saveSections(JSON.stringify(json6list));
        document.getElementById("freetxtMessage").innerHTML = "the free text section was deleted.";
      }
      else{
        alert("Please enter a valid number");
      }
    }

 // -----------------------------------------------------------------------------------------------
 
 //show education
     function showDeleteEdu(listEdu){
       
       console.log(listEdu);
       var EDU0 = JSON.parse(listEdu);
       if (EDU0.length <= 0){
         document.getElementById("pschool").innerHTML = "you haven't entered any education yet. list is empty.";
       }
       else {
         var viewedunum = document.getElementById("text-edu-view").value -1;
         console.log(viewedunum);
         
         if (viewedunum >= EDU0.length || viewedunum < 0){
           document.getElementById("pschool").innerHTML = "does not exist this index";
         }
         else {
           var edu = EDU0[viewedunum];
           document.getElementById("pschool").innerHTML="school:"+edu.school+"<br> major:"+edu.major+"<br> GPA:"+edu.GPA+"<br> class:"+edu.affiliation+"<br>start month:"+edu.startm+"<br>start year:"+edu.starty+"<br>end month:"+edu.endm+"<br>end year:"+edu.endy+" ";
    
         }
       }
    }

//show experience
     function showDeleteEXP(listExp){
       
       console.log(listExp);
       var EXP0 = JSON.parse(listExp);
       if (EXP0.length <= 0){
         document.getElementById("pEXP").innerHTML = "you haven't entered any experience yet. list is empty.";
       }
       else {
         var viewexpnum = document.getElementById("text-exp-view").value -1;
         console.log(viewexpnum);
         
         if (viewexpnum >= EXP0.length || viewexpnum < 0){
           document.getElementById("pEXP").innerHTML = "does not exist this index";
         }
         else {
           var EXP = EXP0[viewexpnum];
           document.getElementById("pEXP").innerHTML="company:"+EXP.company+"<br> position:"+EXP.position+"<br> department:"+EXP.department+"<br> description:"+EXP.description+"<br>supervisor:"+EXP.supervisor+"<br>supervisor contact:"+EXP.contactEmail+"<br>start date:"+EXP.startDate+"<br>end date:"+EXP.endDate+" ";
         
         }
       }
    }

// show header
     function showDeleteHead(jsonHead1){
       console.log(jsonHead1);
       var jhead = JSON.parse(jsonHead1);
       document.getElementById("pH").innerHTML="last name:"+jhead.lname+"<br> first name:"+jhead.fname+"<br> phone:"+jhead.phone+"<br> email:"+jhead.email+"<br>linkedin:"+jhead.lkacc+"<br>profile:"+jhead.porturl+" ";
    }
// show honor
    function showDeleteHonor(listhrn){
       
       console.log(listhrn);
       var HRN0 = JSON.parse(listhrn);
       if (HRN0.length <= 0){
         document.getElementById("pHrn").innerHTML = "you haven't entered any experience yet. list is empty.";
       }
       else {
         var viewhrnnum = document.getElementById("text-hon-view").value -1;
         console.log(viewhrnnum);
         
         if (viewhrnnum >= HRN0.length || viewhrnnum < 0){
           document.getElementById("pHrn").innerHTML = "does not exist this index";
         }
         else {
           var jhrn = HRN0[viewhrnnum];
           document.getElementById("pHrn").innerHTML="awardedHonor:"+jhrn.awardedHonor+"<br>awardedBy:"+jhrn.awardedBy+"<br>description:"+jhrn.description+"<br>awardedYear:"+jhrn.awardedYear+"<br>awardedType:"+jhrn.awardedType+" ";
         }
       }
    }

// show skills
   function showDeleteSkills(listSK){
       
       console.log(listSK);
       var SK0 = JSON.parse(listSK);
       if (SK0.length <= 0){
         document.getElementById("pSK").innerHTML = "you haven't entered any SKILLS yet. list is empty.";
       }
       else {
         var viewSKnum = document.getElementById("text-skl-view").value -1;
         console.log(viewSKnum);
         
         if (viewSKnum >= SK0.length || viewSKnum < 0){
           document.getElementById("pSK").innerHTML = "does not exist this index";
         }
         else {
           var jSK = SK0[viewSKnum];
           console.log(jSK);
           document.getElementById("pSK").innerHTML= "skill name:"+jSK.name+"<br>skill level:"+jSK.level+"<br>";
         }
       }
    }


// show free text 
  function showDeleteSections(listSc){
       
       console.log(listSc);
       var Sc0 = JSON.parse(listSc);
       if (Sc0.length <= 0){
         document.getElementById("pft").innerHTML = "you haven't entered any section yet. list is empty.";
       }
       else {
         var viewScnum = document.getElementById("text-ft-view").value -1;
         console.log(viewScnum);
         
         if (viewScnum >= Sc0.length || viewScnum < 0){
           document.getElementById("pft").innerHTML = "does not exist this index";
         }
         else {
           var jSc = Sc0[viewScnum];
           console.log(jSc);
           document.getElementById("pft").innerHTML= "section name:"+jSc.name+"<br>setion content:"+jSc.content+"<br>";
         }
       }
    }


    </script>


  </head>

  <body>
    
    <h3> current free text </h3>
    <div> 
     <p id="pft"> enter a number starting from 1 to view nth free text section you entered  </p>
    <input type="text" id="text-ft-view" value="">
    <button onclick="google.script.run.withSuccessHandler(showDeleteSections).withUserObject(this).getSections()"> get-one-freetext </button>
 
    <button onclick="google.script.run.withSuccessHandler(deleteCheckedItems6).withUserObject(this).getSections()"> Delete Current Free Text Section </button>
    <p id="freetxtMessage"> </p>
    </div>


    <h3> current skill </h3>
    <div>
    <p id="pSK"> enter a number starting from 1 to view nth skill you entered  </p>
    <input type="text" id="text-skl-view" value="">
    <button onclick="google.script.run.withSuccessHandler(showDeleteSkills).withUserObject(this).getAllSkills()"> get-one-skill </button>
    
      <button onclick = "google.script.run.withSuccessHandler(deleteCheckedItems5).withUserObject(this).getAllSkills()"> Delete Current Skill</button>
     <p id="skillMessage"> </p>
     </div>
      

    <h3> current eduation </h3>
    <div>
    <p id="pschool"> enter a number starting from 1 to view nth education you entered  </p>
    <input type="text" id="text-edu-view" value="">
    <button onclick="google.script.run.withSuccessHandler(showDeleteEdu).withUserObject(this).getEducation()"> get-one-edu </button>
    
    <button onclick = "google.script.run.withSuccessHandler(deleteCheckedItems1).withUserObject(this).getEducation()"> Delete Current Education</button>
    <p id="educationMessage"> </p>
    </div>
    
    <h3> current header </h3>
    <div>
    <p id="pH"> click here to see the header info </p>
    <button onclick="google.script.run.withSuccessHandler(showDeleteHead).withUserObject(this).getHeader()"> get-one-header </button>
    <button onclick = "google.script.run.withSuccessHandler(deleteCheckedItems2).withUserObject(this).getHeader()"> Delete Current header</button>
    <p id="headerMessage"> </p>
    </div>

    <h3> current experience </h3>
    <div>
    <p id="pEXP"> enter a number starting from 1 to view nth experienced you entered </p>
    <input type="text" id="text-exp-view" value="">
    <button onclick="google.script.run.withSuccessHandler(showDeleteEXP).withUserObject(this).getExperience()"> get-one-exp </button>
    
    <button onclick = "google.script.run.withSuccessHandler(deleteCheckedItems3).withUserObject(this).getExperience()"> Delete Current Experience</button>
   <p id="experienceMessage"> </p>
   </div>
   
    <h3> current honor </h3>
    <div>
    <p id="pHrn"> enter a number starting from 1 to view nth honor you entered  </p>
    <input type="text" id="text-hon-view" value="">
    <button onclick="google.script.run.withSuccessHandler(showDeleteHonor).withUserObject(this).getHonor()"> get-one-honor </button>

    <button onclick = "google.script.run.withSuccessHandler(deleteCheckedItems4).withUserObject(this).getHonor()"> Delete Current Honor</button>
   <p id="honorMessage"> </p>
   </div>


  </body>
</html>
